(()=>{"use strict";const t=()=>{const t=new Set;return{attack:(e,o,a)=>!t.has(JSON.stringify([o,a]))&&(t.add(JSON.stringify([o,a])),e.receiveAttack(o,a),e.board)}},e=(t,e,o)=>{let a=e,r=!1;return{name:t,length:e,piece:o,getHits:()=>a,getIsSunk:()=>r,hit:()=>{a-=1,a<=0&&(r=!0)}}},o=()=>{let t=!1,o=17;const a=[],r=[];(()=>{for(let t=0;t<10;t+=1){const t=[];for(let e=0;e<10;e+=1)t.push(null);a.push(t)}})();const l=(t,e,o,l=!0)=>{const{length:s,piece:c}=o;if(l){if(s+e>=10)return!1;for(let o=e;o<s+e;o+=1)if(a[t][o]&&a[t][o])return!1;for(let o=e;o<s+e;o+=1)a[t][o]=c;a[t][e+s-1]=c}else{if(s+t>=10)return!1;for(let o=t;o<t+s;o+=1)if(a[o]&&a[o][e])return!1;for(let o=t;o<t+s;o+=1)a[o]&&(a[o][e]=c);a[t+s-1][e]=c}return r.push(o),!0};return(t=>{const o=()=>Math.floor(10*Math.random());for(let a=0;a<t.length;a+=1){const r=t[a],s=e(r[0],r[1],r[2]);let c=!1;for(;!c;){const t=Math.random()>.5,e=o(),a=o();c=l(e,a,s,t)}}})([["carrier",5,"C"],["battleship",4,"B"],["destroyer",3,"D"],["submarine",3,"S"],["patrol boat",2,"P"]]),{board:a,ships:r,receiveAttack:(e,l)=>{const s=a[l][e];if(s){const c=r.find((t=>t.piece===s));c&&(a[l][e]="X",c.hit(),o-=1,o<=0&&(t=!0,console.log("all Sunk")))}else a[l][e]="O"},getTotalHits:()=>o,getAllSunk:()=>t}},a=t=>{const e=document.querySelectorAll(".player-board .cell");for(let o=0;o<10;o++)for(let a=0;a<10;a++)null!==t[o][a]&&e[10*o+a].classList.add("occupied")},r=(t,e,o,a)=>{const r=document.querySelectorAll(".computer-board .cell");r.forEach((r=>{r.addEventListener("click",(l=>{const s=a.board[l.target.dataset.row][l.target.dataset.column];null===s||"X"==s?r.classList.add("miss"):r.classList.add("hit"),t.attack(a,r.dataset.column,r.dataset.row),setTimeout((()=>{console.table(e.board),console.log("computer move");let t=Math.floor(10*Math.random()),a=Math.floor(10*Math.random());const r=o.attack(e,t,a);for(;!r;)t=Math.floor(10*Math.random()),a=Math.floor(10*Math.random()),o.attack(e,t,a);document.querySelectorAll(".player-board .cell").forEach((o=>{const r=e.board[a][t];o.dataset.row==t&&o.dataset.column==a&&(null!==r&&"O"!==r?o.classList.add("hit"):o.classList.add("miss"))}))}),500)}))})),console.log(r)};(()=>{document.querySelectorAll(".gameboard").forEach((t=>{for(let e=0;e<10;e++)for(let o=0;o<10;o++){const a=document.createElement("div");a.classList.add("cell"),a.dataset.row=e,a.dataset.column=o,t.appendChild(a)}}))})();const l=t(),s=o(),c=t(),n=o();console.table(s.board),a(s.board),r(l,s,c,n)})();